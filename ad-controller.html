<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verifying Access</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<script>
/* ===== AD CONFIG ===== */
const AD_LINK = "https://cuty.io/czF1yj3fN4nM";
const CHAT_PAGE = "RC.html";

/* ===== LOAD STATS ===== */
let stats = JSON.parse(localStorage.getItem("matchly_stats")) || {
  sessionChats: 0,
  totalChats: 0,
  messages: 0,
  adVerified: false
};

/* ===== AD RULE ===== */
function needsAd() {
  if (stats.totalChats < 20) {
    return stats.sessionChats >= 5;
  }
  return stats.sessionChats >= 2;
}

/* ===== FLOW ===== */
if (location.search.includes("ad=done")) {
  stats.sessionChats = 0;
  stats.adVerified = true;
  localStorage.setItem("matchly_stats", JSON.stringify(stats));
  location.href = CHAT_PAGE;
} else {
  if (needsAd()) {
    location.href = AD_LINK;
  } else {
    stats.adVerified = true;
    localStorage.setItem("matchly_stats", JSON.stringify(stats));
    location.href = CHAT_PAGE;
  }
}
</script>

</body>
</html>
